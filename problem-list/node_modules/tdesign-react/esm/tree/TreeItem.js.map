{"version":3,"file":"TreeItem.js","sources":["../../../components/tree/TreeItem.tsx"],"sourcesContent":["import React, {\n  CSSProperties,\n  DragEventHandler,\n  forwardRef,\n  MouseEvent,\n  ReactNode,\n  useRef,\n  DragEvent,\n  isValidElement,\n  useEffect,\n  useState,\n} from 'react';\nimport classNames from 'classnames';\nimport { isFunction } from 'lodash-es';\nimport { CaretRightSmallIcon as TdCaretRightSmallIcon } from 'tdesign-icons-react';\nimport TreeNode from '@tdesign/common-js/tree-v1/tree-node';\nimport type { TypeTreeNodeData } from '@tdesign/common-js/tree-v1/types';\nimport Loading from '../loading';\nimport useRipple from '../hooks/useRipple';\nimport useDomRefCallback from '../hooks/useDomRefCallback';\nimport useGlobalIcon from '../hooks/useGlobalIcon';\nimport Checkbox from '../checkbox';\nimport { useTreeConfig } from './hooks/useTreeConfig';\nimport useDraggable from './hooks/useDraggable';\nimport composeRefs from '../_util/composeRefs';\nimport useConfig from '../hooks/useConfig';\n\nimport type { CheckboxProps } from '../checkbox'\nimport type { TdTreeProps } from './type';\nimport type { TreeItemProps } from './interface';\n\n/**\n * 树节点组件\n */\nconst TreeItem = forwardRef(\n  (\n    props: TreeItemProps & {\n      onTreeItemMounted?: (rowData: { ref: HTMLElement; data: TreeNode }) => void;\n      isVirtual?: boolean;\n      keys: TdTreeProps['keys'];\n      allowDrop?: TdTreeProps['allowDrop'];\n    },\n    ref: React.Ref<HTMLDivElement>,\n  ) => {\n    const {\n      node,\n      icon,\n      label,\n      line,\n      expandOnClickNode,\n      activable,\n      checkProps,\n      operations,\n      onClick,\n      onChange,\n      isVirtual,\n      onTreeItemMounted,\n      allowDrop,\n    } = props;\n\n    const { CaretRightSmallIcon } = useGlobalIcon({\n      CaretRightSmallIcon: TdCaretRightSmallIcon,\n    });\n    const { level } = node;\n    const nodeRef = useRef<HTMLDivElement>(null);\n\n    const { treeClassNames, locale } = useTreeConfig();\n    const { classPrefix } = useConfig();\n\n    useEffect(() => {\n      onTreeItemMounted?.({ ref: nodeRef.current, data: node });\n    }, [isVirtual, nodeRef, node, onTreeItemMounted]);\n\n    const handleClick = (evt: MouseEvent<HTMLDivElement>) => {\n      const srcTarget = evt.target as HTMLElement;\n      const isBranchTrigger =\n        node.children &&\n        expandOnClickNode &&\n        (srcTarget.className === `${classPrefix}-checkbox__input` || srcTarget.tagName.toLowerCase() === 'input');\n\n      if (isBranchTrigger) return;\n\n      // 处理expandOnClickNode时与checkbox的选中的逻辑冲突\n      if (expandOnClickNode && node.children && srcTarget.className?.indexOf?.(`${classPrefix}-tree__label`) !== -1)\n        evt.preventDefault();\n\n      onClick?.(node, {\n        e: evt,\n        expand: expandOnClickNode,\n        active: activable,\n        trigger: 'node-click',\n      });\n    };\n\n    const handleItemClick = (evt: MouseEvent<HTMLDivElement>) => {\n      if (node.loading) {\n        return;\n      }\n      onClick?.(node, {\n        e: evt,\n        expand: true,\n        active: false,\n        trigger: 'icon-click',\n      });\n    };\n\n    const handleIconClick = (evt: MouseEvent<HTMLDivElement>) => {\n      if (!icon) return;\n      evt.stopPropagation();\n      handleItemClick(evt);\n    };\n\n    const stopPropagation = (e: MouseEvent) => {\n      e.stopPropagation();\n    };\n\n    /* ======== render ======= */\n    const renderIcon = () => {\n      // 这里按 vue 的逻辑定义\n      let isDefaultIcon = false;\n      const renderIconNode = () => {\n        if (icon === false) {\n          return null;\n        }\n        if (icon instanceof Function) {\n          return icon(node.getModel());\n        }\n        if (React.isValidElement(icon)) {\n          return icon;\n        }\n        if (icon && icon !== true) {\n          // 非 ReactNode、Function、Boolean 类型，抛出错误提示\n          throw new Error('invalid type of icon');\n        }\n\n        if (!node.isLeaf()) {\n          isDefaultIcon = true;\n          if (node.loading && node.expanded) {\n            return <Loading loading={true} />;\n          }\n\n          return <CaretRightSmallIcon className={treeClassNames.treeIconRight} />;\n        }\n        return null;\n      };\n\n      const iconNode = renderIconNode();\n      return (\n        <span\n          className={classNames(treeClassNames.treeIcon, treeClassNames.folderIcon, {\n            [treeClassNames.treeIconDefault]: isDefaultIcon,\n          })}\n          onClick={handleIconClick}\n        >\n          {iconNode}\n        </span>\n      );\n    };\n\n    const renderLine = () => {\n      const iconVisible = icon !== false;\n\n      if (line === false) {\n        return null;\n      }\n\n      if (isFunction(line)) {\n        return line(node.getModel());\n      }\n\n      if (React.isValidElement(line)) {\n        return line;\n      }\n\n      if (node.parent && node.tree) {\n        // 如果节点的父节点，不是最后的节点\n        // 则需要绘制节点延长线\n        const shadowStyles: string[] = [];\n        const parents = node.getParents();\n        parents.pop();\n        parents.forEach((pnode: TreeNode, index: number) => {\n          if (!pnode.vmIsLast) {\n            shadowStyles.push(`calc(-${index + 1} * var(--space)) 0 var(--color)`);\n          }\n        });\n\n        const styles = {\n          '--level': level,\n          boxShadow: shadowStyles.join(','),\n        };\n\n        return (\n          <span\n            className={classNames(\n              // 每个节点绘制抵达上一层级的折线\n              treeClassNames.line,\n              {\n                // 叶子节点，折线宽度延长，因为没有 icon 呈现\n                // 任意节点，icon 不呈现时也是要延长折线宽度\n                [treeClassNames.lineIsLeaf]: node.vmIsLeaf || !iconVisible,\n                // 分支首节点，到上一节点的折线高度要缩短，让位给 icon 呈现\n                // 如果 icon 隐藏了，则不必缩短折线高度\n                [treeClassNames.lineIsFirst]: node.vmIsFirst && iconVisible,\n              },\n            )}\n            style={styles}\n            onClick={stopPropagation}\n          />\n        );\n      }\n      return null;\n    };\n\n    // 使用 斜八角动画\n    const [labelDom, setRefCurrent] = useDomRefCallback();\n    useRipple(labelDom);\n\n    // setData需要强制刷新组件来更新数据\n    const [, updateRender] = useState({});\n\n    const renderLabel = () => {\n      const emptyView = locale('empty');\n      let labelText: string | ReactNode = '';\n      if (label instanceof Function) {\n        const { setData: nodeSetData, ...rest } = node.getModel();\n        labelText =\n          label({\n            ...rest,\n            // 拦截setData render tree-item\n            setData: (value: TypeTreeNodeData) => {\n              nodeSetData(value);\n              updateRender({});\n            },\n          }) || emptyView;\n      } else {\n        labelText = node.label || emptyView;\n      }\n\n      const labelClasses = classNames(treeClassNames.treeLabel, treeClassNames.treeLabelStrictly, {\n        [treeClassNames.actived]: node.isActivable() ? node.actived : false,\n      });\n\n      if (node.isCheckable()) {\n        let checkboxProps: CheckboxProps;\n        if (typeof checkProps === 'function') {\n          checkboxProps = checkProps(node.getModel());\n        } else {\n          checkboxProps = checkProps;\n        }\n        return (\n          <Checkbox\n            ref={setRefCurrent}\n            checked={node.checked}\n            indeterminate={node.indeterminate}\n            disabled={node.disabled}\n            name={String(node.value)}\n            onChange={(_, ctx) => onChange(node, ctx)}\n            className={labelClasses}\n            stopLabelTrigger={expandOnClickNode && !!node.children}\n            {...checkboxProps}\n          >\n            <span data-target=\"label\">{labelText}</span>\n          </Checkbox>\n        );\n      }\n      return (\n        <span\n          ref={setRefCurrent}\n          data-target=\"label\"\n          className={labelClasses}\n          // label 可以传入 ReactNode， 如果直接取里面的 children 值，当多层级的时候会有问题\n          // 所以这里判断如果 label是 ReactNode， 并且 text没有值 就不展示 title\n          title={isValidElement(node.label) && !node.data?.text ? '' : String(node.data?.text || node.label)}\n        >\n          <span style={{ position: 'relative' }}>{labelText}</span>\n        </span>\n      );\n    };\n\n    const renderOperations = () => {\n      let operationsView = null;\n      if (operations) {\n        // ReactNode 类型处理\n        if (React.isValidElement(operations)) {\n          operationsView = operations;\n        } else if (operations instanceof Function) {\n          // Function 类型处理\n          const treeNodeModel = node?.getModel();\n          operationsView = operations(treeNodeModel);\n        } else {\n          // 非 ReactNode、Function 类型，抛出错误提示\n          throw new Error('invalid type of operations');\n        }\n      }\n\n      if (operationsView) {\n        return (\n          <span className={treeClassNames.treeOperations} data-target=\"operations\" onClick={stopPropagation}>\n            {operationsView}\n          </span>\n        );\n      }\n      return null;\n    };\n\n    const { setDragStatus, isDragging, dropPosition, isDragOver } = useDraggable({\n      node,\n      nodeRef,\n      allowDrop,\n    });\n\n    const handleDragStart: DragEventHandler<HTMLDivElement> = (evt: DragEvent<HTMLDivElement>) => {\n      const { node } = props;\n      if (!node.isDraggable()) return;\n      evt.stopPropagation();\n      setDragStatus('dragStart', evt);\n\n      try {\n        // ie throw error firefox-need-it\n        evt.dataTransfer?.setData('text/plain', '');\n      } catch (e) {\n        // empty\n      }\n    };\n    const handleDragEnd: DragEventHandler<HTMLDivElement> = (evt: DragEvent<HTMLDivElement>) => {\n      const { node } = props;\n      if (!node.isDraggable()) return;\n      evt.stopPropagation();\n      setDragStatus('dragEnd', evt);\n    };\n    const handleDragOver: DragEventHandler<HTMLDivElement> = (evt: DragEvent<HTMLDivElement>) => {\n      const { node } = props;\n      if (!node.isDraggable()) return;\n      evt.stopPropagation();\n      evt.preventDefault();\n      setDragStatus('dragOver', evt);\n    };\n    const handleDragLeave: DragEventHandler<HTMLDivElement> = (evt: DragEvent<HTMLDivElement>) => {\n      const { node } = props;\n      if (!node.isDraggable()) return;\n      evt.stopPropagation();\n      setDragStatus('dragLeave', evt);\n    };\n    const handleDrop: DragEventHandler<HTMLDivElement> = (evt: DragEvent<HTMLDivElement>) => {\n      const { node } = props;\n\n      if (!node.isDraggable()) return;\n      evt.stopPropagation();\n      evt.preventDefault();\n      setDragStatus('drop', evt);\n    };\n\n    return (\n      <div\n        ref={composeRefs(ref, nodeRef)}\n        data-value={node.value}\n        data-level={level}\n        className={classNames(treeClassNames.treeNode, {\n          [treeClassNames.treeNodeOpen]: node.expanded,\n          [treeClassNames.actived]: node.isActivable() ? node.actived : false,\n          [treeClassNames.disabled]: node.isDisabled(),\n          [treeClassNames.treeNodeDraggable]: !node.isDisabled() && node.isDraggable(),\n          [treeClassNames.treeNodeDragging]: isDragging,\n          [treeClassNames.treeNodeDragTipTop]: isDragOver && dropPosition < 0,\n          [treeClassNames.treeNodeDragTipBottom]: isDragOver && dropPosition > 0,\n          [treeClassNames.treeNodeDragTipHighlight]: !isDragging && isDragOver && dropPosition === 0,\n        })}\n        style={\n          {\n            '--level': level,\n            boxShadow: '',\n          } as CSSProperties\n        }\n        onClick={handleClick}\n        draggable={!node.isDisabled() && node.isDraggable()}\n        onDragStart={handleDragStart}\n        onDragEnd={handleDragEnd}\n        onDragOver={handleDragOver}\n        onDragLeave={handleDragLeave}\n        onDrop={handleDrop}\n      >\n        {renderLine()}\n        {renderIcon()}\n        {renderLabel()}\n        {renderOperations()}\n      </div>\n    );\n  },\n);\n\nTreeItem.displayName = 'TreeItem';\n\nexport default TreeItem;\n"],"names":["TreeItem","forwardRef","props","ref","node","icon","label","line","expandOnClickNode","activable","checkProps","operations","onClick","onChange","isVirtual","onTreeItemMounted","allowDrop","_useGlobalIcon","useGlobalIcon","CaretRightSmallIcon","TdCaretRightSmallIcon","level","nodeRef","useRef","_useTreeConfig","useTreeConfig","treeClassNames","locale","_useConfig","useConfig","classPrefix","useEffect","current","data","handleClick","evt","_srcTarget$className","_srcTarget$className$","srcTarget","target","isBranchTrigger","children","className","concat","tagName","toLowerCase","indexOf","call","preventDefault","e","expand","active","trigger","handleItemClick","loading","handleIconClick","stopPropagation","renderIcon","isDefaultIcon","renderIconNode","Function","getModel","React","isValidElement","Error","isLeaf","expanded","createElement","Loading","treeIconRight","iconNode","classNames","treeIcon","folderIcon","_defineProperty","treeIconDefault","renderLine","iconVisible","isFunction","parent","tree","shadowStyles","parents","getParents","pop","forEach","pnode","index","vmIsLast","push","styles","boxShadow","join","lineIsLeaf","vmIsLeaf","lineIsFirst","vmIsFirst","style","_useDomRefCallback","useDomRefCallback","_useDomRefCallback2","_slicedToArray","labelDom","setRefCurrent","useRipple","_useState","useState","_useState2","updateRender","renderLabel","_node$data","_node$data2","emptyView","labelText","_node$getModel","nodeSetData","setData","rest","_objectWithoutProperties","_excluded","_objectSpread","value","labelClasses","treeLabel","treeLabelStrictly","actived","isActivable","isCheckable","checkboxProps","Checkbox","checked","indeterminate","disabled","name","String","_","ctx","stopLabelTrigger","title","text","position","renderOperations","operationsView","treeNodeModel","treeOperations","_useDraggable","useDraggable","setDragStatus","isDragging","dropPosition","isDragOver","handleDragStart","isDraggable","_evt$dataTransfer","dataTransfer","handleDragEnd","handleDragOver","handleDragLeave","handleDrop","composeRefs","treeNode","treeNodeOpen","isDisabled","treeNodeDraggable","treeNodeDragging","treeNodeDragTipTop","treeNodeDragTipBottom","treeNodeDragTipHighlight","draggable","onDragStart","onDragEnd","onDragOver","onDragLeave","onDrop","displayName"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCMA,IAAAA,QAAW,gBAAAC,UAAA,CACf,UACEC,OAMAC,GACG,EAAA;AACG,EAAA,IACJC,IAAA,GAaEF,KAAA,CAbFE,IAAA;IACAC,IAAA,GAYEH,KAAA,CAZFG,IAAA;IACAC,KAAA,GAWEJ,KAAA,CAXFI,KAAA;IACAC,IAAA,GAUEL,KAAA,CAVFK,IAAA;IACAC,iBAAA,GASEN,KAAA,CATFM,iBAAA;IACAC,SAAA,GAQEP,KAAA,CARFO,SAAA;IACAC,UAAA,GAOER,KAAA,CAPFQ,UAAA;IACAC,UAAA,GAMET,KAAA,CANFS,UAAA;IACAC,OAAA,GAKEV,KAAA,CALFU,OAAA;IACAC,SAAA,GAIEX,KAAA,CAJFW,QAAA;IACAC,SAAA,GAGEZ,KAAA,CAHFY,SAAA;IACAC,iBAAA,GAEEb,KAAA,CAFFa,iBAAA;IACAC,SAAA,GACEd,KAAA,CADFc,SAAA,CAAA;EAGI,IAAAC,cAAA,GAA0BC,aAAc,CAAA;AAC5CC,MAAAA,mBAAqB,EAAAC,mBAAAA;AACvB,KAAC,CAAA;IAFOD,qBAAoB,GAAAF,cAAA,CAApBE,mBAAoB,CAAA;AAGtB,EAAA,IAAEE,QAAUjB,IAAA,CAAViB;AACF,EAAA,IAAAC,OAAA,GAAUC,OAAuB,IAAI,CAAA,CAAA;AAE3C,EAAA,IAAAC,cAAA,GAAmCC,aAAc,EAAA;IAAzCC,cAAA,GAAAF,cAAA,CAAAE,cAAA;IAAgBC,MAAO,GAAAH,cAAA,CAAPG,MAAO,CAAA;AACzB,EAAA,IAAAC,UAAA,GAAkBC,SAAU,EAAA;IAA1BC,WAAY,GAAAF,UAAA,CAAZE,WAAY,CAAA;AAEpBC,EAAAA,SAAA,CAAU,YAAM;AACdhB,IAAAA,iBAAA,KAAAA,IAAAA,IAAAA,iBAAA,KAAAA,KAAAA,CAAAA,IAAAA,iBAAA,CAAoB;MAAEZ,GAAK,EAAAmB,OAAA,CAAQU,OAAS;AAAAC,MAAAA,IAAA,EAAM7B,IAAAA;AAAK,KAAC,CAAA,CAAA;KACvD,CAACU,SAAA,EAAWQ,OAAS,EAAAlB,IAAA,EAAMW,iBAAiB,CAAC,CAAA,CAAA;AAE1C,EAAA,IAAAmB,WAAA,GAAc,SAAdA,WAAAA,CAAeC,GAAoC,EAAA;IAAA,IAAAC,oBAAA,EAAAC,qBAAA,CAAA;AACvD,IAAA,IAAMC,YAAYH,GAAI,CAAAI,MAAA,CAAA;IAChB,IAAAC,eAAA,GACJpC,IAAK,CAAAqC,QAAA,IACLjC,iBACC,KAAA8B,SAAA,CAAUI,SAAc,KAAAC,EAAAA,CAAAA,MAAA,CAAGb,WAAiC,EAAA,kBAAA,CAAA,IAAAQ,SAAA,CAAUM,OAAQ,CAAAC,WAAA,EAAkB,KAAA,OAAA,CAAA,CAAA;AAE/F,IAAA,IAAAL,eAAA,EAAiB,OAAA;AAGjB,IAAA,IAAAhC,iBAAA,IAAqBJ,KAAKqC,QAAY,IAAA,EAAAL,oBAAA,GAAAE,SAAA,CAAUI,mFAAVN,oBAAA,CAAqBU,OAAU,MAAA,IAAA,IAAAT,qBAAA,KAAA,KAAA,CAAA,GAAA,KAAA,CAAA,GAA/BA,qBAAA,CAAAU,IAAA,CAAAX,oBAAA,EAAA,EAAA,CAAAO,MAAA,CAAkCb,4BAAyB,CAAM,MAAA,CAAA,CAAA,EACzGK,GAAA,CAAIa,cAAe,EAAA,CAAA;AAErBpC,IAAAA,OAAA,aAAAA,OAAA,KAAA,KAAA,CAAA,IAAAA,OAAA,CAAUR,IAAM,EAAA;AACd6C,MAAAA,CAAG,EAAAd,GAAA;AACHe,MAAAA,MAAQ,EAAA1C,iBAAA;AACR2C,MAAAA,MAAQ,EAAA1C,SAAA;AACR2C,MAAAA,OAAS,EAAA,YAAA;AACX,KAAC,CAAA,CAAA;GACH,CAAA;AAEM,EAAA,IAAAC,eAAA,GAAkB,SAAlBA,eAAAA,CAAmBlB,GAAoC,EAAA;IAC3D,IAAI/B,KAAKkD,OAAS,EAAA;AAChB,MAAA,OAAA;AACF,KAAA;AACA1C,IAAAA,OAAA,aAAAA,OAAA,KAAA,KAAA,CAAA,IAAAA,OAAA,CAAUR,IAAM,EAAA;AACd6C,MAAAA,CAAG,EAAAd,GAAA;AACHe,MAAAA,MAAQ,EAAA,IAAA;AACRC,MAAAA,MAAQ,EAAA,KAAA;AACRC,MAAAA,OAAS,EAAA,YAAA;AACX,KAAC,CAAA,CAAA;GACH,CAAA;AAEM,EAAA,IAAAG,eAAA,GAAkB,SAAlBA,eAAAA,CAAmBpB,GAAoC,EAAA;IAC3D,IAAI,CAAC9B,IAAA,EAAM,OAAA;IACX8B,GAAA,CAAIqB,eAAgB,EAAA,CAAA;IACpBH,eAAA,CAAgBlB,GAAG,CAAA,CAAA;GACrB,CAAA;AAEM,EAAA,IAAAqB,eAAA,GAAkB,SAAlBA,eAAAA,CAAmBP,CAAkB,EAAA;IACzCA,CAAA,CAAEO,eAAgB,EAAA,CAAA;GACpB,CAAA;AAGA,EAAA,IAAMC,aAAa,SAAbA,aAAmB;IAEvB,IAAIC,aAAgB,GAAA,KAAA,CAAA;AACpB,IAAA,IAAMC,iBAAiB,SAAjBA,iBAAuB;MAC3B,IAAItD,SAAS,KAAO,EAAA;AACX,QAAA,OAAA,IAAA,CAAA;AACT,OAAA;MACA,IAAIA,gBAAgBuD,QAAU,EAAA;AACrB,QAAA,OAAAvD,IAAA,CAAKD,IAAK,CAAAyD,QAAA,EAAU,CAAA,CAAA;AAC7B,OAAA;AACI,MAAA,iBAAAC,KAAA,CAAMC,cAAe,CAAA1D,IAAI,CAAG,EAAA;AACvB,QAAA,OAAAA,IAAA,CAAA;AACT,OAAA;AACI,MAAA,IAAAA,IAAA,IAAQA,SAAS,IAAM,EAAA;AAEnB,QAAA,MAAA,IAAI2D,MAAM,sBAAsB,CAAA,CAAA;AACxC,OAAA;AAEI,MAAA,IAAA,CAAC5D,IAAK,CAAA6D,MAAA,EAAU,EAAA;AACFP,QAAAA,aAAA,GAAA,IAAA,CAAA;AACZ,QAAA,IAAAtD,IAAA,CAAKkD,OAAW,IAAAlD,IAAA,CAAK8D,QAAU,EAAA;AACjC,UAAA,sBAAQJ,KAAA,CAAAK,aAAA,CAAAC,OAAA,EAAA;AAAQd,YAAAA,OAAS,EAAA,IAAA;AAAM,WAAA,CAAA,CAAA;AACjC,SAAA;AAEA,QAAA,sBAAQQ,KAAA,CAAAK,aAAA,CAAAhD,qBAAA,EAAA;UAAoBuB,WAAWhB,cAAe,CAAA2C,aAAAA;AAAe,SAAA,CAAA,CAAA;AACvE,OAAA;AACO,MAAA,OAAA,IAAA,CAAA;KACT,CAAA;AAEA,IAAA,IAAMC,WAAWX,cAAe,EAAA,CAAA;AAChC,IAAA,sBACGG,KAAA,CAAAK,aAAA,CAAA,MAAA,EAAA;AACCzB,MAAAA,SAAW,EAAA6B,UAAA,CAAW7C,cAAe,CAAA8C,QAAA,EAAU9C,eAAe+C,UAAY,EAAAC,eAAA,KACvEhD,eAAeiD,eAAkB,EAAAjB,aAAA,CACnC,CAAA;AACD9C,MAAAA,OAAS,EAAA2C,eAAAA;KAAA,EAERe,QACH,CAAA,CAAA;GAEJ,CAAA;AAEA,EAAA,IAAMM,aAAa,SAAbA,aAAmB;AACvB,IAAA,IAAMC,cAAcxE,IAAS,KAAA,KAAA,CAAA;IAE7B,IAAIE,SAAS,KAAO,EAAA;AACX,MAAA,OAAA,IAAA,CAAA;AACT,KAAA;AAEI,IAAA,IAAAuE,UAAA,CAAWvE,IAAI,CAAG,EAAA;AACb,MAAA,OAAAA,IAAA,CAAKH,IAAK,CAAAyD,QAAA,EAAU,CAAA,CAAA;AAC7B,KAAA;AAEI,IAAA,iBAAAC,KAAA,CAAMC,cAAe,CAAAxD,IAAI,CAAG,EAAA;AACvB,MAAA,OAAAA,IAAA,CAAA;AACT,KAAA;AAEI,IAAA,IAAAH,IAAA,CAAK2E,MAAU,IAAA3E,IAAA,CAAK4E,IAAM,EAAA;MAG5B,IAAMC,eAAyB,EAAC,CAAA;AAC1B,MAAA,IAAAC,OAAA,GAAU9E,KAAK+E,UAAW,EAAA,CAAA;MAChCD,OAAA,CAAQE,GAAI,EAAA,CAAA;AACJF,MAAAA,OAAA,CAAAG,OAAA,CAAQ,UAACC,KAAA,EAAiBC,KAAkB,EAAA;AAC9C,QAAA,IAAA,CAACD,MAAME,QAAU,EAAA;UACNP,YAAA,CAAAQ,IAAA,CAAA9C,QAAAA,CAAAA,MAAA,CAAc4C,KAAA,GAAQ,CAAkC,EAAA,iCAAA,CAAA,CAAA,CAAA;AACvE,SAAA;AACF,OAAC,CAAA,CAAA;AAED,MAAA,IAAMG,MAAS,GAAA;AACb,QAAA,SAAW,EAAArE,KAAA;AACXsE,QAAAA,SAAA,EAAWV,YAAa,CAAAW,IAAA,CAAK,GAAG,CAAA;OAClC,CAAA;AAEA,MAAA,sBACG9B,KAAA,CAAAK,aAAA,CAAA,MAAA,EAAA;AACCzB,QAAAA,SAAW,EAAA6B,UAAA,CAET7C,cAAe,CAAAnB,IAAA,EAAAmE,eAAA,CAAAA,eAAA,CAAA,EAAA,EAIZhD,cAAA,CAAemE,UAAa,EAAAzF,IAAA,CAAK0F,YAAY,CAACjB,WAAA,CAAA,EAG9CnD,cAAA,CAAeqE,WAAc,EAAA3F,IAAA,CAAK4F,SAAa,IAAAnB,WAAA,CAEpD,CAAA;AACAoB,QAAAA,KAAO,EAAAP,MAAA;AACP9E,QAAAA,OAAS,EAAA4C,eAAAA;AACX,OAAA,CAAA,CAAA;AAEJ,KAAA;AACO,IAAA,OAAA,IAAA,CAAA;GACT,CAAA;AAGA,EAAA,IAAA0C,kBAAA,GAAkCC,iBAAkB,EAAA;IAAAC,mBAAA,GAAAC,cAAA,CAAAH,kBAAA,EAAA,CAAA,CAAA;AAA7CI,IAAAA,QAAA,GAAAF,mBAAA,CAAA,CAAA,CAAA;AAAUG,IAAAA,aAAa,GAAAH,mBAAA,CAAA,CAAA,CAAA,CAAA;EAC9BI,SAAA,CAAUF,QAAQ,CAAA,CAAA;AAGlB,EAAA,IAAAG,SAAA,GAAyBC,QAAA,CAAS,EAAE,CAAA;IAAAC,UAAA,GAAAN,cAAA,CAAAI,SAAA,EAAA,CAAA,CAAA;AAA3BG,IAAAA,YAAY,GAAAD,UAAA,CAAA,CAAA,CAAA,CAAA;AAErB,EAAA,IAAME,cAAc,SAAdA,cAAoB;IAAA,IAAAC,UAAA,EAAAC,WAAA,CAAA;AAClB,IAAA,IAAAC,SAAA,GAAYrF,OAAO,OAAO,CAAA,CAAA;IAChC,IAAIsF,SAAgC,GAAA,EAAA,CAAA;IACpC,IAAI3G,iBAAiBsD,QAAU,EAAA;AAC7B,MAAA,IAAAsD,cAAA,GAA0C9G,KAAKyD,QAAS,EAAA;QAAvCsD,WAAA,GAAAD,cAAA,CAATE,OAAS;AAAgBC,QAAAA,IAAK,GAAAC,wBAAA,CAAAJ,cAAA,EAAAK,SAAA,CAAA,CAAA;AACtCN,MAAAA,SAAA,GACE3G,KAAM,CAAAkH,aAAA,CAAAA,aAAA,KACDH,IAAA,CAAA,EAAA,EAAA,EAAA;AAEHD,QAAAA,OAAA,EAAS,SAATA,OAAAA,CAAUK,KAA4B,EAAA;UACpCN,WAAA,CAAYM,KAAK,CAAA,CAAA;UACjBb,YAAA,CAAa,EAAE,CAAA,CAAA;AACjB,SAAA;OACD,CAAA,CAAK,IAAAI,SAAA,CAAA;AACV,KAAO,MAAA;AACLC,MAAAA,SAAA,GAAY7G,KAAKE,KAAS,IAAA0G,SAAA,CAAA;AAC5B,KAAA;AAEA,IAAA,IAAMU,YAAe,GAAAnD,UAAA,CAAW7C,cAAe,CAAAiG,SAAA,EAAWjG,eAAekG,iBAAmB,EAAAlD,eAAA,CACzFhD,EAAAA,EAAAA,cAAe,CAAAmG,OAAA,EAAUzH,KAAK0H,WAAY,EAAA,GAAI1H,KAAKyH,OAAU,GAAA,KAAA,CAC/D,CAAA,CAAA;AAEG,IAAA,IAAAzH,IAAA,CAAK2H,aAAe,EAAA;AAClB,MAAA,IAAAC,aAAA,CAAA;AACA,MAAA,IAAA,OAAOtH,eAAe,UAAY,EAAA;QACpBsH,aAAA,GAAAtH,UAAA,CAAWN,IAAK,CAAAyD,QAAA,EAAU,CAAA,CAAA;AAC5C,OAAO,MAAA;AACWmE,QAAAA,aAAA,GAAAtH,UAAA,CAAA;AAClB,OAAA;AACA,MAAA,sBACGoD,KAAA,CAAAK,aAAA,CAAA8D,QAAA,EAAAT,aAAA,CAAA;AACCrH,QAAAA,GAAK,EAAAoG,aAAA;QACL2B,SAAS9H,IAAK,CAAA8H,OAAA;QACdC,eAAe/H,IAAK,CAAA+H,aAAA;QACpBC,UAAUhI,IAAK,CAAAgI,QAAA;AACfC,QAAAA,IAAA,EAAMC,MAAO,CAAAlI,IAAA,CAAKqH,KAAK,CAAA;AACvB5G,QAAAA,UAAU,SAAVA,SAAW0H,CAAA,EAAGC,GAAQ,EAAA;AAAA,UAAA,OAAA3H,SAAA,CAAST,MAAMoI,GAAG,CAAA,CAAA;AAAA,SAAA;AACxC9F,QAAAA,SAAW,EAAAgF,YAAA;AACXe,QAAAA,gBAAkB,EAAAjI,iBAAA,IAAqB,CAAC,CAACJ,IAAK,CAAAqC,QAAAA;OAC1CuF,EAAAA,aAAA,kBAEHlE,KAAA,CAAAK,aAAA,CAAA,MAAA,EAAA;AAAK,QAAA,aAAY,EAAA,OAAA;OAAA,EAAS8C,SAAU,CACvC,CAAA,CAAA;AAEJ,KAAA;AACA,IAAA,sBACGnD,KAAA,CAAAK,aAAA,CAAA,MAAA,EAAA;AACChE,MAAAA,GAAK,EAAAoG,aAAA;AACL,MAAA,aAAY,EAAA,OAAA;AACZ7D,MAAAA,SAAW,EAAAgF,YAAA;AAGXgB,MAAAA,KAAO,eAAA3E,cAAA,CAAe3D,IAAK,CAAAE,KAAK,KAAK,EAAAwG,CAAAA,UAAA,GAAC1G,IAAA,CAAK6B,IAAM,MAAA6E,IAAAA,IAAAA,UAAA,eAAXA,UAAA,CAAW6B,IAAA,CAAA,GAAO,KAAKL,MAAO,CAAA,CAAAvB,CAAAA,WAAA,GAAA3G,IAAA,CAAK6B,IAAM,MAAA8E,IAAAA,IAAAA,WAAA,uBAAXA,WAAA,CAAW4B,IAAA,KAAQvI,KAAKE,KAAK,CAAA;AAAA,KAAA,iBAEhGwD,KAAA,CAAAK,aAAA,CAAA,MAAA,EAAA;AAAK8B,MAAAA,KAAA,EAAO;AAAE2C,QAAAA,QAAA,EAAU,UAAA;AAAW,OAAA;KAAA,EAAI3B,SAAU,CACpD,CAAA,CAAA;GAEJ,CAAA;AAEA,EAAA,IAAM4B,mBAAmB,SAAnBA,mBAAyB;IAC7B,IAAIC,cAAiB,GAAA,IAAA,CAAA;AACrB,IAAA,IAAInI,UAAY,EAAA;AAEV,MAAA,iBAAAmD,KAAA,CAAMC,cAAe,CAAApD,UAAU,CAAG,EAAA;AACnBmI,QAAAA,cAAA,GAAAnI,UAAA,CAAA;AACnB,OAAA,MAAA,IAAWA,sBAAsBiD,QAAU,EAAA;QAEnC,IAAAmF,aAAA,GAAgB3I,SAAAA,IAAAA,IAAAA,2BAAAA,KAAMyD,QAAS,EAAA,CAAA;AACrCiF,QAAAA,cAAA,GAAiBnI,WAAWoI,aAAa,CAAA,CAAA;AAC3C,OAAO,MAAA;AAEC,QAAA,MAAA,IAAI/E,MAAM,4BAA4B,CAAA,CAAA;AAC9C,OAAA;AACF,KAAA;AAEA,IAAA,IAAI8E,cAAgB,EAAA;AAClB,MAAA,sBACGhF,KAAA,CAAAK,aAAA,CAAA,MAAA,EAAA;QAAKzB,WAAWhB,cAAe,CAAAsH,cAAA;AAAgB,QAAA,aAAY,EAAA,YAAA;AAAapI,QAAAA,OAAS,EAAA4C,eAAAA;OAAA,EAC/EsF,cACH,CAAA,CAAA;AAEJ,KAAA;AACO,IAAA,OAAA,IAAA,CAAA;GACT,CAAA;EAEA,IAAAG,aAAA,GAAgEC,YAAa,CAAA;AAC3E9I,MAAAA,IAAA,EAAAA,IAAA;AACAkB,MAAAA,OAAA,EAAAA,OAAA;AACAN,MAAAA,SAAA,EAAAA,SAAAA;AACF,KAAC,CAAA;IAJOmI,aAAe,GAAAF,aAAA,CAAfE,aAAe;IAAAC,UAAA,GAAAH,aAAA,CAAAG,UAAA;IAAYC,YAAc,GAAAJ,aAAA,CAAdI,YAAc;IAAAC,UAAA,GAAAL,aAAA,CAAAK,UAAA,CAAA;AAM3C,EAAA,IAAAC,eAAA,GAAoD,SAApDA,eAAAA,CAAqDpH,GAAmC,EAAA;AACtF,IAAA,IAAE/B,KAAAA,GAASF,KAAA,CAATE,IAAAA,CAAAA;AACJ,IAAA,IAAA,CAACA,MAAKoJ,WAAY,EAAA,EAAG,OAAA;IACzBrH,GAAA,CAAIqB,eAAgB,EAAA,CAAA;AACpB2F,IAAAA,aAAA,CAAc,aAAahH,GAAG,CAAA,CAAA;IAE1B,IAAA;AAAA,MAAA,IAAAsH,iBAAA,CAAA;AAEE,MAAA,CAAAA,iBAAA,GAAAtH,GAAA,CAAAuH,YAAA,MAAAD,IAAAA,IAAAA,iBAAA,KAAAA,KAAAA,CAAAA,IAAAA,iBAAA,CAAcrC,OAAQ,CAAA,YAAA,EAAc,EAAE,CAAA,CAAA;AAC5C,aAASnE,CAAP,EAAA,EAEF;GACF,CAAA;AACM,EAAA,IAAA0G,aAAA,GAAkD,SAAlDA,aAAAA,CAAmDxH,GAAmC,EAAA;AACpF,IAAA,IAAE/B,KAAAA,GAASF,KAAA,CAATE,IAAAA,CAAAA;AACJ,IAAA,IAAA,CAACA,MAAKoJ,WAAY,EAAA,EAAG,OAAA;IACzBrH,GAAA,CAAIqB,eAAgB,EAAA,CAAA;AACpB2F,IAAAA,aAAA,CAAc,WAAWhH,GAAG,CAAA,CAAA;GAC9B,CAAA;AACM,EAAA,IAAAyH,cAAA,GAAmD,SAAnDA,cAAAA,CAAoDzH,GAAmC,EAAA;AACrF,IAAA,IAAE/B,KAAAA,GAASF,KAAA,CAATE,IAAAA,CAAAA;AACJ,IAAA,IAAA,CAACA,MAAKoJ,WAAY,EAAA,EAAG,OAAA;IACzBrH,GAAA,CAAIqB,eAAgB,EAAA,CAAA;IACpBrB,GAAA,CAAIa,cAAe,EAAA,CAAA;AACnBmG,IAAAA,aAAA,CAAc,YAAYhH,GAAG,CAAA,CAAA;GAC/B,CAAA;AACM,EAAA,IAAA0H,eAAA,GAAoD,SAApDA,eAAAA,CAAqD1H,GAAmC,EAAA;AACtF,IAAA,IAAE/B,KAAAA,GAASF,KAAA,CAATE,IAAAA,CAAAA;AACJ,IAAA,IAAA,CAACA,MAAKoJ,WAAY,EAAA,EAAG,OAAA;IACzBrH,GAAA,CAAIqB,eAAgB,EAAA,CAAA;AACpB2F,IAAAA,aAAA,CAAc,aAAahH,GAAG,CAAA,CAAA;GAChC,CAAA;AACM,EAAA,IAAA2H,UAAA,GAA+C,SAA/CA,UAAAA,CAAgD3H,GAAmC,EAAA;AACjF,IAAA,IAAE/B,KAAAA,GAASF,KAAA,CAATE,IAAAA,CAAAA;AAEJ,IAAA,IAAA,CAACA,MAAKoJ,WAAY,EAAA,EAAG,OAAA;IACzBrH,GAAA,CAAIqB,eAAgB,EAAA,CAAA;IACpBrB,GAAA,CAAIa,cAAe,EAAA,CAAA;AACnBmG,IAAAA,aAAA,CAAc,QAAQhH,GAAG,CAAA,CAAA;GAC3B,CAAA;AAEA,EAAA,sBACG2B,KAAA,CAAAK,aAAA,CAAA,KAAA,EAAA;AACChE,IAAAA,GAAA,EAAK4J,WAAY,CAAA5J,GAAA,EAAKmB,OAAO,CAAA;IAC7B,cAAYlB,IAAK,CAAAqH,KAAA;AACjB,IAAA,YAAY,EAAApG,KAAA;IACZqB,SAAA,EAAW6B,UAAW,CAAA7C,cAAA,CAAesI,QAAU,EAAAtF,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAAA,eAAA,CAAA,EAAA,EAC5ChD,cAAe,CAAAuI,YAAA,EAAe7J,IAAK,CAAA8D,QAAA,CACnCxC,EAAAA,cAAe,CAAAmG,OAAA,EAAUzH,KAAK0H,WAAY,EAAA,GAAI1H,KAAKyH,OAAU,GAAA,KAAA,CAC7DnG,EAAAA,cAAA,CAAe0G,QAAW,EAAAhI,IAAA,CAAK8J,UAAW,EAAA,GAC1CxI,eAAeyI,iBAAoB,EAAA,CAAC/J,KAAK8J,UAAW,EAAA,IAAK9J,KAAKoJ,WAAY,EAAA,CAC1E9H,EAAAA,eAAe0I,gBAAmB,EAAAhB,UAAA,CAClC1H,EAAAA,cAAA,CAAe2I,kBAAqB,EAAAf,UAAA,IAAcD,YAAe,GAAA,CAAA,CAAA,EACjE3H,cAAA,CAAe4I,qBAAwB,EAAAhB,UAAA,IAAcD,YAAe,GAAA,CAAA,CAAA,EACpE3H,cAAe,CAAA6I,wBAAA,EAA2B,CAACnB,UAAA,IAAcE,cAAcD,YAAiB,KAAA,CAAA,CAC1F,CAAA;AACDpD,IAAAA,KACE,EAAA;AACE,MAAA,SAAW,EAAA5E,KAAA;AACXsE,MAAAA,SAAW,EAAA,EAAA;KACb;AAEF/E,IAAAA,OAAS,EAAAsB,WAAA;AACTsI,IAAAA,WAAW,CAACpK,IAAA,CAAK8J,UAAW,EAAA,IAAK9J,KAAKoJ,WAAY,EAAA;AAClDiB,IAAAA,WAAa,EAAAlB,eAAA;AACbmB,IAAAA,SAAW,EAAAf,aAAA;AACXgB,IAAAA,UAAY,EAAAf,cAAA;AACZgB,IAAAA,WAAa,EAAAf,eAAA;AACbgB,IAAAA,MAAQ,EAAAf,UAAAA;AAAA,GAAA,EAEPlF,YACA,EAAAnB,UAAA,IACAoD,WAAY,EAAA,EACZgC,kBACH,CAAA,CAAA;AAEJ,CACF,EAAA;AAEA7I,QAAA,CAAS8K,WAAc,GAAA,UAAA;;;;"}